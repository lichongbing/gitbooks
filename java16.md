<a id="3"></a>
### 新蜂商城

#### 要点

* 新蜂商城功能模块和流程设计详解

* 前端页面设计及技术选型

* 页面布局制作及跳转逻辑实现

* Spring Boot 整合 kaptcha 实现验证码功能

* 新蜂商城后台管理系统登录功能实现

* 登陆拦截器设置并完善身份验证

* 通用分页功能设计与开发实践

* 技术选型之 Spring Boot

* JqGrid 插件整合制作分页效果

* Spring Boot 实践之文件上传处理及路径回显

* 新蜂商城轮播图管理模块开发

* 新蜂商城分类管理模块开发

第一部分的多篇文章已经详细的介绍 Spring Boot 技术栈的相关知识，由 Spring Boot 的基础使用讲到 Spring Boot 的源码解读，包括 Spring Boot 整合 Thymeleaf 制作页面、Spring Boot 整合 MyBatis 操作数据库、Spring Boot 源码分析、Spring Boot 自动配置流程讲解，这些知识点主要是起到过渡的作用，让大家能够有基础的环境搭建能力和 Spring Boot 开发能力。之后是商城系统的开发实战，主要包括商城后台管理系统的开发和商城端的功能开发，在实践过程中我们将整合多个独立的基础功能到一个完整的功能模块中，最终完成各个模块的功能和交互。

按照课程规划，从本篇文章开始，我们就进入项目实战的课程部分，本文我将向朋友们介绍我们接下来要做一个什么样的项目、项目里设计了哪些功能模块以及用户行为与功能模块的关联，介绍完这些之后将在后续的文章中讲解如何一步一步去完成这个项目。

## 需求确定

在正式进入开发之前，首先我们应该确定开发需求，简单的介绍一下商城系统。

![](https://user-gold-cdn.xitu.io/2019/10/30/16e1c01073a5d603?w=1280&h=720&f=png&s=14284)

程序员是一个非常务实的群体，这种性格品质用最经典的一句话来概括就是“**废话少说，放码过来**”，不搞虚头巴脑，是骡子是马拉出来遛遛，而且特别强调项目经验和实战经验。很多开发人员也因此特别注重项目实践，在做项目练习时有很多种类，也会随着个人技术的不断提升而不断变化，最简单的可能是学生管理系统、工资管理系统等等的各种管理系统，之后可能会做一个博客项目或者论坛项目，当然，线上商城系统也是一个不可或缺的一种类型。

### 什么是商城系统？

**商城系统就是功能完善的网上销售系统，与传统的市场一样，商城系统也会提供交易时所必须的信息交换、支付结算和实物配送这些基础服务，可以让用户通过网络实现购物行为。**

像京东、唯品会、天猫这些都是网上商城，这种项目通常包含如下元素：

*   会员模块
*   商品模块
*   订单模块
*   支付模块

当然，由于系统的完善程度不同，可能还会有仓库模块、物流模块、营销模块等等内容。

![online-mall](https://user-gold-cdn.xitu.io/2019/10/30/16e1c01072dc1491?w=4000&h=3000&f=jpeg&s=719581)

网上商城是在为个人用户和企业用户提供人性化的全方位服务，努力为用户创造亲切、轻松和愉悦的购物环境；不断丰富产品结构，最大化地满足消费者日趋多样的购物需求。并凭借更具竞争力的价格和逐渐完善的物流配送体系等各项优势，赢得市场占有率多年稳居行业首位的骄人成绩，也是时代发展的趋势。

### 为什么要做商城系统？

*   **热度高**

电子商务这些年在国内的高速发展加速了为电子商务服务的软件行业的发展，随之诞生了很多与之密切相关的网店和商城系统。对于网上商城系统的实现技术，无论是开源的亦或者是商业性质的，都非常的丰富，因此商城系统时一个炽手可热的种类，很多开发人员都会尝试着去开发一套线上商城系统。

*   **知识点复杂**

商城系统也是一个比较复杂的系统，牵涉的技术内容比较多，而且功能点和技术栈要求也比较高，从零搭建一个商城系统，这个过程不仅考验着开发人员的技术储备丰富度，更考验着技术使用的熟练度，同时对于开发人员的系统设计能力也有要求(系统如何切分，功能点如何设计，页面结构和交互如何优化等)，这些技术栈的掌握程度和项目整体的统筹规划都在一定程度上代表着一个技术人员的能力。

开发和统筹一个完整的大型商城系统往往要求技术人员了解很多不同的技术或者框架，比如常用的前端页面模板和基本的 Web 开发知识、后端开发技术框架(如 Spring Boot 、模板引擎、ORM 框架等)、服务器基础设施(如基础的 shell 命令，Nginx 、 MySQL 等常用软件的搭建和使用)都需进行全局考虑和选择。

*   **产品流程完整**

横向来梳理一个商城系统的产品流程，从零到正式上线访问所涉及的项目环节如下，产品设计、原型设计、功能开发、功能测试、产品上线、后期维护等环节缺一不可，开发人员可能不太关注完整的流程，但是能够掌握整个流程的基本脉络对于日后的提升会有极大的帮助。

![process](https://user-gold-cdn.xitu.io/2019/10/30/16e1c01072ef8f79?w=1280&h=568&f=png&s=213408)

## 新蜂商城系统介绍

newbee-mall 项目（中文直译即为新蜂商城）是我发布到开源平台的一套线上商城系统，包括 newbee-mall 商城系统及 newbee-mall-admin 商城后台管理系统，基于 Spring Boot 2.X 及相关技术栈开发。 前台商城系统包含首页门户、商品分类、新品上线、首页轮播、商品推荐、商品搜索、商品展示、购物车、订单结算、订单流程、个人订单管理、会员中心、帮助中心等模块。 后台管理系统包含数据面板、轮播图管理、商品管理、订单管理、会员管理、分类管理、设置等模块。

该项目包含两个系统：

*   商城系统
*   商城后台管理系统

对应的，也包含两种用户体系，一种是商城会员，另一种是商城后台的管理员，在商城系统中，是所有用户都可以浏览使用的系统，商城会员在这里可以浏览、搜索、购买商品并完成购买行为。另一个是商城后台管理系统，管理员在此管理商品信息、订单信息、会员信息等，具体包括商城基本信息的录入和更改、商品信息的添加和编辑、处理订单的拣货和出库，还有商城会员信息的管理。

在小册的开篇词中我已经给出了新蜂商城的页面预览图，这里就简单的看一下好了：

*   商城首页
    
    ![index](https://user-gold-cdn.xitu.io/2019/10/13/16dc4a1b6c71958c?w=1280&h=840&f=png&s=157293)
    
*   商品搜索
    
    ![search](https://user-gold-cdn.xitu.io/2019/10/13/16dc4a1b690ee1b5?w=1280&h=960&f=png&s=59801)
    
*   订单列表
    
    ![orders](https://user-gold-cdn.xitu.io/2019/10/13/16dc4a1ba8933e9c?w=1280&h=960&f=png&s=26066)
    

以上就是最终效果，当然还包括后台管理系统，这里就不占用篇幅了。它就是一个通常意义上的商城项目，该项目包含商城系统的一些共有属性和功能，页面设计以及流程设计也是完全按照商城系统来开发和处理的。

## 功能详解

大项目虽然复杂，但是也不是完全无法实现，只要我们计划合理、选用的解决方案有效就能够完成这项任务，行业内普遍的一个解决方案就是**拆**。化繁为简，我们将大项目拆解成若干个小项目，大系统拆分出若干个功能模块，大功能拆解成若干个小功能，之后再对各个环节或者各个功能做具体的实现和完善，比如如何做好功能设计、如何做好接口设计、如何进行表结构设计，具体到功能可能就有如何实现登录功能、如何实现文件上传、如何实现一个分页功能、如何实现分类的三级联动、搜索功能怎样实现、订单流程如何设计等等，当我们将其各个击破并且全部完善的时候，这个完整的项目也就逐渐展现在我们面前。

有些同学可能根据前一篇文章的部署教程已经完成了部署并且体验了大部分功能，为了加深大家的理解并且能够更好的学习该项目，我也把项目中所涉及到的功能点全部列举出来。

### 商城端功能整理

newbee mall 商城系统所有的功能点列举如下（**建议放大图片查看**）：

![mall](https://user-gold-cdn.xitu.io/2019/10/30/16e1c01073e25aed?w=1361&h=522&f=png&s=54277)

*   **首页**

用户进入商城首页后，首先会看到管理员设置的分类信息和轮播图，之后是配置的热销商品等模块，这些数据都是在后台管理系统中配置好的运营数据，在商城端直接读取并且显示到页面即可。

*   **浏览**

接下来用户可以选择直接浏览商品信息，也可以根据分类或者关键字去搜索商品，这是用户的浏览行为。

*   **登录和注册**

在浏览时我们需要判断用户是否登录，这里就牵涉到商城用户的注册和登录功能了。如果不是商城的注册用户，很多行为是会被限制掉的，此时在商城浏览的用户可以选择填写信息并注册为我们的商城用户，之后就能够登录并且使用商城端的所有功能。

*   **选择商品**

登录用户可以在商城网站上任性壕气的浏览、挑选商品，此时就引出了商城的购物车功能，用户可以将商品放到购物车中，可以增加、删除、修改购物车中的商品以及商品数量，这些功能点已经在新蜂商城系统中实现。

*   **提交订单**

壕气的用户终于要下手了，在确定了需要购买的商品和数量后，就可以执行提交订单的操作，仅仅选择商品是不行的，我们还需要把用户的收货信息给记录下来。以上这些信息都处理完毕后，就到了订单环节，此时的用户点击结算按钮，我们的系统中也就对应的生成了一笔订单数据。

*   **订单流程**

用户在成功的提交订单后，就可以正式的进入到订单操作环节，此时可以选择三个操作：

1.  此时的订单尚未支付，选择去支付流程
2.  下单玩玩，不去管支付流程，继续购物或者退出系统
3.  不想买了或者商品拍错，选择取消订单

以上就是订单模块的流程，包括订单列表功能、订单详情功能、订单取消功能、选择支付方式、支付功能。

*   **确认收货**

这是订单流程的最后一个环节，此环节需要商家来配合，用户在支付成功之后订单就进入到商家的管理系统中进行后续的处理，在操作了拣货和配送两个订单状态之后，用户就能够在订单详情页面点击**确认收货**，此时订单的正向流程就顺利完结了。

因为还有取消订单和关闭订单等操作，所以我们把**下单->支付->确认收货**这个流程称为正向流程。

![module](https://user-gold-cdn.xitu.io/2019/11/4/16e34806a3e35765?w=1280&h=847&f=png&s=281576)

### 后台管理系统功能整理

newbee mall 后台管理系统所有的功能点列举如下（**建议放大图片查看**）：

![admin](https://user-gold-cdn.xitu.io/2019/10/30/16e1c01073d93ae4?w=1729&h=522&f=png&s=68113)

后台管理系统中的所有功能模块主要是为了让商城管理员去操作运营数据以及管理用户交易数据，这里通常就是基本的增删改查功能，当然，其中肯定包括商城系统所通用的业务处理逻辑，功能点都在上方的图片中。

*   **轮播图管理**

轮播图这种交互方式，在 web 时代似乎已经司空见惯，尤其是购物网站，基本都会留下一定的版面来放置轮播图，后台管理系统中的这个管理模块就是用来添加和编辑轮播图，你在首页看到的轮播图都是在后台配置好的。

*   **商品分类管理**

商城中的商品数据繁多，对商品进行分类有利于提供管理效率，同时也能够根据目标用户的需求，用规范的分类数据提高用户的搜索体验，更快更精准的找到需要的商品。后台管理系统中的这个管理模块就是用来添加和编辑分类数据，之后你可以在商品信息中与该数据进行关联，这样就可以在商城端看到商品的分类信息。

*   **热销商品、推荐商品管理**

在商城首页可以看到最新的商品列表、热卖商品以及推荐商品，这些商品并不需要搜索，而是优先在首页展现给顾客作为选购时的参考，这些数据也是运营人员在后台管理系统中进行配置，根据实际情况进行这些数据的添加和编辑。

*   **商品管理**

商品管理系统是整个电商系统的数据基础，用于记录与商品有关的数据，虽然系统逻辑不复杂，但是由于操作的数据比较多，需要注意很多细节，首页推荐营销、订单模块、支付模块及物流模块都需要从商品中心获取数据。 商品管理模块主要包括商品的内容编辑以及属性的编辑，由于字段较多，该模块的开发也是比较复杂的，因为牵涉到的知识点比较多。

*   **订单管理**

订单的生成并不在后台管理系统中实现的，在商城端由用户发起订单流程后，才会在订单管理页面出现对应的订单数据，也只有在用户完成支付后，后台管理员才能够对订单流程的后续操作进行处理，比如出库、发货等等流程。

*   **会员管理**

与订单模块类似，会员记录的生成操作也是在商城端来发起的，用户在完成注册之后，数据库中就会出现一条会员记录，信息的编辑也是由用户在个人中心操作的，后台管理系统中只是做了基础的列表和用户状态变更功能。

*   **系统设置**

该模块主要是系统管理员信息的处理，包括基本信息的修改功能和密码修改功能。

### 商城架构整理

商城的技术选型我们介绍完毕，功能点也进行了拆解，这里我简单的整理了一下项目的架构图供大家参考，图片如下（**建议放大图片查看**）：

![admin](https://user-gold-cdn.xitu.io/2019/10/30/16e1c010748b19b4?w=1843&h=1503&f=png&s=217081)

主要包括系统的逻辑架构以及实际的基础设施搭建，供大家参考，希望通过这张图片也能让大家得到另外一个层面的思考，不只是使用新蜂商城，也不只是要去弄懂新蜂商城的源码，更要从宏观一些的角度来理解一个项目。

## 总结

首先介绍了商城系统的相关知识点，让大家更清楚的认识到我们要做的项目以及为什么要做这个项目，紧接着过渡到我们这次的主角--**新蜂商城**项目，之后结合用户在网页上的行为路径讲解了一下新蜂商城所开发的所有功能点，最后整理了一张简单的系统结构图，希望大家也能够更立体的去看待这个商城项目，我们不仅仅要去拆解它，也要能够看到一个线上项目的脉络结构。文中讲到的更多的其实是功能划分，以及如何看待和理解一个商城系统，也希望大家能够通过我的讲解能够自己搭建和完善一个大型的商城系统。

接下来就是商城系统的开发，再具体一点就是每个功能模块的开发，再具体一点就是每个页面、每个接口的开发，同时也是它们涉及到的每个知识点的讲解，希望通过我的讲解和知识点的拆分，让大家对这个系统的认识能够更加透彻和清晰。虽然这个项目是我开发的，但是这篇文章也花费了我一周的事件去思考和整理，**商城项目特性、用户行为记录整理、系统功能点的拆分及图片制作、还有系统架构图的制作**，整理这些对于我来说，也是一个重新学习和巩固的过程，有心的朋友也可以按照十三的思路继续去探索和学习，

不仅仅如此，也希望朋友们可以举一反三将知识点扩展开来，以上这些不仅仅是咱们这个商城项目才需要注意的，也可以引申到其他类型的系统，对于系统设计和功能点的拆分、罗列也可以用到其他系统中，能够对自己所做项目的每一个细节、每一个知识点，涉及到的方方面面都有一个较为清晰的认识（当然，也不可能面面俱到，那就尽量做到吧），只有这样才能够在心中构建一个良好的知识体系，以后再碰到问题也就可以迎刃而解了。